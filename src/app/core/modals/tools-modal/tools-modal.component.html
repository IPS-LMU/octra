<div bsModal #modal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="dialog-sizes-name1"
     id="supportedfiles" (onHidden)="onHidden()">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">{{"general.tools" | transloco}}</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="close()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="tools-table" #content>
        <table class="table table-striped" [ngStyle]="{
          width: content.offsetWidth - 50 + 'px'
        }">
          <thead>
          <tr>
            <th></th>
            <th>{{'general.name' | transloco}}</th>
            <th>{{'general.description' | transloco}}</th>
            <th></th>
          </tr>
          </thead>
          <tbody>
          <!-- combine phrases tool -->
          <tr>
            <td (click)="tools.combinePhrases.opened = !tools.combinePhrases.opened">
              <fa-icon style="color:gray;"
                       [icon]="['fas', ((tools.combinePhrases.opened) ? 'chevron-up' : 'chevron-down')]"></fa-icon>
            </td>
            <td (click)="tools.combinePhrases.opened = !tools.combinePhrases.opened">
              <a #a>
                {{'tools.combine phrases.name' | transloco}}
              </a>
            </td>
            <td colspan="2"
                (click)="tools.combinePhrases.opened = !tools.combinePhrases.opened">{{'tools.combine phrases.description' | transloco}}</td>
          </tr>
          <tr
            [@fadeToggle]="(tools.combinePhrases.opened) ? 'active': 'inactive'">
            <td></td>
            <td colspan="4" style="padding-left:20px;">
              <div class="card" style="padding:10px;" *ngIf="navbarServ.transcrService !== undefined">
                <div class="alert alert-warning">
                  {{'tools.combine phrases.warning' | transloco}}
                </div>
                <div class="configurator">
                  <form>
                    <table class="table" style="max-width: 400px;">
                      <tbody>
                      <tr>
                        <td><label
                          for="minSilenceLength">{{'tools.combine phrases.minimal silence' | transloco}}</label>
                        </td>
                        <td>
                          <input type="number" id="minSilenceLength" name="minSilenceLength"
                                 [(ngModel)]="tools.combinePhrases.options.minSilenceLength"/>
                        </td>
                        <td>
                          <fa-icon icon="question-circle" style="color: darkblue;"
                                   [tooltip]="transloco.translate('tools.combine phrases.minimal silence desc')"
                                   placement="right"></fa-icon>
                        </td>
                      </tr>
                      <tr>
                        <td><label
                          for="maxWordsPerSegment">{{'tools.combine phrases.maximal words' | transloco}}</label>
                        </td>
                        <td>
                          <input type="number" id="maxWordsPerSegment" name="maxWordsPerSegment"
                                 [(ngModel)]="tools.combinePhrases.options.maxWordsPerSegment"/>
                        </td>
                        <td>
                          <fa-icon icon="question-circle" style="color: darkblue;"
                                   [tooltip]="transloco.translate('tools.combine phrases.maximal words desc')"
                                   placement="right"></fa-icon>
                        </td>
                      </tr>
                      </tbody>
                    </table>
                  </form>
                  <button class="btn btn-primary btn-raised" (click)="onCombinePhrasesClick()"
                          [disabled]="!isCombinePhrasesSettingsValid">{{'tools.combine phrases.name' | transloco}}</button>
                </div>
              </div>
            </td>
          </tr>

          <!-- cut audio files -->
          <tr *ngIf="navbarServ.transcrService !== undefined
                     && navbarServ.transcrService.audioManager.originalInfo.extension === '.wav'">
            <td (click)="tools.audioCutting.opened = !tools.audioCutting.opened">
              <fa-icon style="color:gray;"
                       [icon]="['fas', ((tools.audioCutting.opened) ? 'chevron-up' : 'chevron-down')]"></fa-icon>
            </td>
            <td (click)="tools.audioCutting.opened = !tools.audioCutting.opened">
              <a #a>
                {{'tools.cut audio.name' | transloco}}
              </a>
            </td>
            <td colspan="3"
                (click)="tools.audioCutting.opened = !tools.audioCutting.opened">{{'tools.cut audio.description' | transloco}}</td>
          </tr>
          <tr *ngIf="navbarServ.transcrService !== undefined
                    && navbarServ.transcrService.audioManager.originalInfo.extension === '.wav'"
              [@fadeToggle]="(tools.audioCutting.opened) ? 'active': 'inactive'">
            <td></td>
            <td colspan="4" style="padding-left:20px;">
              <div class="card" style="padding:10px;" *ngIf="navbarServ.transcrService !== undefined">
                <a (click)="tools.audioCutting.showConfigurator = !tools.audioCutting.showConfigurator"
                   class="show-configurator-link"
                >
                  <ng-container *ngIf="tools.audioCutting.showConfigurator">
                    <fa-icon style="color:gray;"
                             [icon]="['fas', 'chevron-up']"></fa-icon>
                    {{"tools.cut audio.hide configurator" | transloco}}
                  </ng-container>
                  <ng-container *ngIf="!tools.audioCutting.showConfigurator">
                    <fa-icon style="color:gray;"
                             [icon]="['fas', 'chevron-down']"></fa-icon>
                    {{"tools.cut audio.show configurator" | transloco}}
                  </ng-container>
                </a>
                <div class="configurator" [hidden]="!tools.audioCutting.showConfigurator">
                  <app-naming-drag-and-drop #namingConvention
                                            [fileName]="navbarServ.transcrService.audioManager.ressource.name"
                                            [firstSegment]="navbarServ.transcrService.currentlevel.segments.get(0)"
                  ></app-naming-drag-and-drop>

                  <div class="form-control">
                    <span>{{'tools.cut audio.append meta files' | transloco}}: </span>
                    <div class="form-check form-check-inline"
                         *ngFor="let exportFormat of tools.audioCutting.exportFormats; let i = index;">
                      <input class="form-check-input" type="checkbox" id="inlineCheckbox{{i}}"
                             [value]="exportFormat.value"
                             [(ngModel)]="tools.audioCutting.exportFormats[i].selected">
                      <label class="form-check-label"
                             for="inlineCheckbox{{i}}">{{exportFormat.label}}</label>
                    </div>
                  </div>
                </div>
                <div class="progress-area" style="text-align: center;">
                  <button *ngIf="tools.audioCutting.status !== 'running'"
                          class="btn btn-primary btn-raised" (click)="splitAudio()"
                          [disabled]="namingConvention.resultConvention.length === 1"
                          style="max-width:200px;margin-top:20px;">{{'tools.cut audio.name' | transloco}}
                  </button>
                  <button *ngIf="tools.audioCutting.status === 'running'"
                          class="btn btn-danger btn-raised" (click)="stopAudioSplitting()"
                          style="max-width:200px;margin-top:20px;">{{'general.stop' | transloco}}
                  </button>
                  <div class="mb-2" *ngIf="tools.audioCutting.status !== 'idle'">
                    <progressbar [animate]="true" [value]="tools.audioCutting.progress"
                                 [type]="tools.audioCutting.progressbarType">
                      <b>

                        {{ tools.audioCutting.progress | number : '1.2-2'}}%
                      </b>
                    </progressbar>
                    <div class="text-danger" style="padding:10px;"
                         *ngIf="tools.audioCutting.status === 'failed'">{{tools.audioCutting.message}}</div>
                  </div>
                  <ng-container
                    *ngIf="tools.audioCutting.status !== 'idle' && tools.audioCutting.status !== 'finished' && tools.audioCutting.timeLeft > 0">
                    Time left: {{tools.audioCutting.timeLeft | timespan2}}
                  </ng-container>
                  <a style="margin-left:10px;"
                     *ngIf="tools.audioCutting.result.url !== null"
                     download="{{tools.audioCutting.result.filename}}"
                     [href]="tools.audioCutting.result.url"
                     class="link">
                    <fa-icon icon="save"></fa-icon>
                    {{'general.download' | transloco}}
                  </a>
                </div>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="close()">
          {{"general.close" | transloco}}
        </button>
      </div>
    </div>
  </div>
</div>
