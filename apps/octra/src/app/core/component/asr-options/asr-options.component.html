<span class="asr-label">ASR -</span>
<div id="asr-bar">
  <div #dropdown="bs-dropdown" [insideClick]="true"
       class="btn-group"
       dropdown
       id="dropdown-button" placement="down right">
    <label for="button-basic" style="vertical-align: middle;margin-right:10px;">{{"general.Language" | transloco}}
      : </label>
    <button aria-controls="dropdown-basic" class="btn btn-outline-secondary btn-sm dropdown-toggle" dropdownToggle
            id="button-basic"
            type="button">
      <ng-container *ngIf="asrService.selectedLanguage === undefined; else asrAllSet">
        {{"asr.without asr" | transloco}}
      </ng-container>
      <ng-template #asrAllSet>
        {{asrService.selectedLanguage.name}} ({{getShortCode(asrService.selectedLanguage.code)}})
        [{{asrService.selectedLanguage.asr}}]
      </ng-template>
      <span class="caret"></span>
    </button>
    <div *dropdownMenu aria-labelledby="button-basic"
         class="dropdown-menu"
         id="dropdown-basic" role="menu" style="padding:5px;height:300px;overflow-y: scroll;">
      <p style="font-size: 0.9em;text-align: center;">
        {{"asr.click on logo" | transloco}}
      </p>
      <table class="table table-hover languageTable">
        <thead>
        <tr>
          <th>{{"general.Language" | transloco}}</th>
          <th>{{"general.Service Provider" | transloco}}</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td (click)="onASRLangChanged(undefined)" colspan="2">{{"asr.without asr" | transloco}}</td>
        </tr>
        <ng-container *ngFor="let lang of appSettings.octra.plugins.asr.languages; let i = index;">
          <tr [ngClass]="{
                            selected:  !(asrService.selectedLanguage === undefined)
                                        && (asrService.selectedLanguage.code === lang.code)
                                        && (asrService.selectedLanguage.asr === lang.asr)
                            }"
          >
            <td (click)="onASRLangChanged(lang)" class="col-language">
              <ng-container
                *ngIf="lang !== undefined && lang.state === 'active'">
                {{lang.name}} ({{getShortCode(lang.code)}}) [{{lang.asr}}]
              </ng-container>
              <ng-container
                *ngIf="lang !== undefined && lang.state === 'inactive'">
                {{lang.name}} ({{getShortCode(lang.code)}}) [{{lang.asr}}] (currently not
                available)
              </ng-container>
            </td>
            <td class="col-asr">
              <img #pop="bs-popover" (click)="pop.toggle();"
                   [outsideClick]="true"
                   [popover]="asrDescription" [src]="serviceProviders[lang.asr]?.logoURL" class="logo"
                   popoverTitle="Service Information"
                   container="#asr-bar"
                   triggers="focus"
              >
              <ng-template #asrDescription>
                <table class="table table-sm table-borderless">
                  <tbody>
                  <tr>
                    <td>
                      <fa-icon icon="database"></fa-icon>
                    </td>
                    <td>
                      {{serviceProviders[lang.asr]?.dataStoragePolicy}}
                    </td>
                  </tr>
                  <tr *ngIf="serviceProviders[lang.asr].maxSignalDuration !== undefined">
                    <td>
                      <fa-icon icon="exclamation-triangle"></fa-icon>
                    </td>
                    <td>
                      max audio duration: {{serviceProviders[lang.asr].maxSignalDuration}} seconds
                    </td>
                  </tr>
                  <tr *ngIf="serviceProviders[lang.asr].maxSignalSize !== undefined">
                    <td>
                      <fa-icon icon="exclamation-triangle"></fa-icon>
                    </td>
                    <td>
                      max file size: {{serviceProviders[lang.asr].maxSignalSize}} MB
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <fa-icon [icon]="['far', 'handshake']"></fa-icon>
                    </td>
                    <td>
                      <a [href]="serviceProviders[lang.asr]?.termsURL"
                         target="_blank">Terms
                        &amp; Conditions</a>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <fa-icon icon="globe"></fa-icon>
                    </td>
                    <td>
                      <a [href]="serviceProviders[lang.asr]?.homepageURL"
                         target="_blank">Homepage</a>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </ng-template>
            </td>
          </tr>
        </ng-container>
        </tbody>
      </table>
    </div>
  </div>
  <div #dropdown2="bs-dropdown"
       [isDisabled]="asrService.selectedLanguage === undefined || asrService.selectedLanguage === undefined"
       class="btn-group"
       dropdown id="dropdown-button2" placement="down right"
       style="margin-left:10px;">
    <button aria-controls="dropdown-basic" class="btn btn-outline-primary btn-sm dropdown-toggle" dropdownToggle
            id="button-basic2"
            type="button">
      {{"general.SELECT ACTION" | transloco}}
      <span class="caret"></span>
    </button>
    <div *dropdownMenu aria-labelledby="button-basic"
         class="dropdown-menu"
         id="dropdown-basic2" role="menu" style="padding:5px;">

      <ng-container *ngIf="asrService.queue.status !== 'STARTED'">
        <li role="menuitem">
          <button (click)="startASRForThisSegment()"
                  class="dropdown-item">{{"asr.start this segment" | transloco}}</button>
        </li>
        <li role="menuitem">
          <button (click)="startASRForAllSegmentsNext()"
                  class="dropdown-item">{{"asr.start for all next" | transloco}}</button>
        </li>
      </ng-container>
      <ng-container *ngIf="asrService.queue.status === 'STARTED'">
        <li role="menuitem">
          <button (click)="stopASRForThisSegment()"
                  class="dropdown-item">{{"asr.stop this segment" | transloco}}</button>
        </li>
        <li role="menuitem">
          <button class="dropdown-item">{{"asr.stop for all next" | transloco}}</button>
        </li>
        <li role="menuitem">
          <button (click)="stopASRForAll()" class="dropdown-item">{{"asr.stop all" | transloco}}</button>
        </li>
      </ng-container>
    </div>
    <a [href]="manualURL + 'using-asr'" style="margin-left: 10px;" target="_blank">
      <fa-icon class="text-info" icon="question-circle" size="2x" style="display: inline-block;"></fa-icon>
    </a>
  </div>
  <div class="clearfix"></div>
</div>
<div class="clearfix"></div>
