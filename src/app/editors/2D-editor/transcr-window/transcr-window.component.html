<div id="window" #window>
  <div class="window-nav-top">
    <fa-icon icon="times" class="close" (click)="close();"></fa-icon>
  </div>
  <div #main>
    <div class="tw-loading" [ngStyle]="{
    width: mainSize.width + 'px',
    height: mainSize.height + 'px'
    }" *ngIf="loading">
      <div class="background" [ngStyle]="{
    width: mainSize.width + 'px',
    height: mainSize.height + 'px'
    }"></div>
      <fa-icon icon="spinner" spin="spin" size="4x"></fa-icon>
    </div>
    <app-asr-options [audioChunk]="audiochunk" [enabled]="editor.rawText === ''"
                     *ngIf="settingsService.isASREnabled"></app-asr-options>
    <occo-audio-navigation #audionav
                           [audioChunk]="audiochunk"
                           [playbackRate]="appStorage.audioSpeed"
                           [volume]="appStorage.audioVolume"
                           (buttonClick)="onButtonClick($event)"
                           (keyup)="onKeyUp()"
                           (afterVolumeChange)="afterVolumeChange($event)"
                           (afterPlaybackRateChange)="afterSpeedChange($event)"
                           [responsive]="settingsService.responsive.enabled"
                           [buttons]="{
                        play: {
                            label: ('general.play' | transloco),
                            shortcut: keyMap.getShortcut('overlay', 'play_pause')
                        },
                        pause: {
                            label: ('general.pause' | transloco),
                            shortcut: keyMap.getShortcut('overlay', 'play_pause')
                        },
                        stop: {
                            label: ('general.stop' | transloco),
                            shortcut: keyMap.getShortcut('overlay', 'stop')
                        },
                        replay: {
                            label: ('general.replay' | transloco),
                            shortcut: ''
                        },
                        backward: {
                            label: ('general.backward' | transloco),
                            shortcut: keyMap.getShortcut('overlay', 'step_backward')
                        },
                        backwardtime: {
                            label: ('general.backward' | transloco),
                            shortcut: keyMap.getShortcut('overlay', 'step_backwardtime')
                        }
                      }"
                           [easyMode]="easymode"

    ></occo-audio-navigation>
    <occo-audio-viewer #loupe id="loupe"
                       [transcriptionLevel]="transcrService.currentlevel"
                       (shortcuttriggered)="onShortCutTriggered($event, 'loupe')"
                       [audioChunk]="audiochunk"
                       [isMultiLine]="false"
    ></occo-audio-viewer>
    <app-transcr-editor #editor id="trancr"
                        (markerInsert)="onMarkerInsert($event)"
                        (markerClick)="onMarkerClick($event)"
                        [markers]="transcrService.guidelines?.markers"
                        [easymode]="easymode"
                        [audiochunk]="audiochunk"
                        (boundaryclicked)="onBoundaryClicked($event)"
                        (boundaryinserted)="onBoundaryInserted()"
                        (typing)="afterTyping($event)"
                        [validationEnabled]="validationEnabled"
                        [height]="100"
    ></app-transcr-editor>
    <div class="window-nav-bottom">
      <div class="row" role="group">
        <button class="btn btn-info btn-raised col-md-4" (click)="save();doDirectionAction('left');">
                            <span *ngIf="responsive || easymode"
                                  [ngClass]="{'d-lg-none': responsive && !easymode}">
                                <fa-icon icon="save"></fa-icon> & <fa-icon icon="arrow-left"></fa-icon>
                            </span>
          <span *ngIf="!easymode" [ngClass]="{'d-none d-lg-inline': responsive}">
                             {{"general.save" | transloco}} &
            {{"segments.previous" | transloco}}
                            </span>
        </button>
        <button class="btn btn-info btn-raised col-md-4" (click)="save();close();">
                            <span *ngIf="responsive || easymode"
                                  [ngClass]="{'d-lg-none': responsive && !easymode}">
                                <fa-icon icon="save"></fa-icon>
                            </span>
          <span *ngIf="!easymode" [ngClass]="{'d-none d-lg-inline': responsive}">
                             {{"general.save" | transloco}} & {{"general.close" | transloco}}
                            </span>
        </button>
        <button class="btn btn-info btn-raised col-md-4" (click)="save();doDirectionAction('right');"
                *ngIf="hasSegmentBoundaries || (!isNextSegmentLastAndBreak(segmentIndex)
                    && segmentIndex < transcrService.currentlevel.segments.length - 1)">
                            <span *ngIf="responsive || easymode"
                                  [ngClass]="{'d-lg-none': responsive && !easymode}">
                                <fa-icon icon="save"></fa-icon> & <fa-icon icon="arrow-right"></fa-icon>
                            </span>
          <span *ngIf="!easymode" [ngClass]="{'d-none d-lg-inline': responsive}">
                             {{"general.save" | transloco}} &
            {{"segments.next" | transloco}}
                            </span>
        </button>
        <!-- check if last segment ord if the next segment is a break -->
        <button class="btn btn-info btn-raised col-md-4" (click)="save();close();openOverview();"
                *ngIf="!hasSegmentBoundaries && (segmentIndex === transcrService.currentlevel.segments.length - 1
                    || isNextSegmentLastAndBreak(segmentIndex))">
                            <span *ngIf="responsive || easymode"
                                  [ngClass]="{'d-lg-none': responsive && !easymode}">
                                <fa-icon icon="save"></fa-icon> & <fa-icon icon="eye"></fa-icon>
                            </span>
          <span *ngIf="!easymode" [ngClass]="{'d-none d-lg-inline': responsive}">
          {{"general.save" | transloco}} & {{"general.overview" | transloco}}
        </span>
        </button>
      </div>
    </div>
  </div>
</div>
<div id="black" (click)="close()"></div>
