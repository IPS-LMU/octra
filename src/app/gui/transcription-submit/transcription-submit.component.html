<modal #modal>
    <modal-header>
        <h4 class="modal-title">{{"modal.transcription.send.header" | translate}}</h4>
    </modal-header>
    <modal-body>
        {{"modal.transcription.send.text" | translate}}
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-primary" (click)="modal.dismiss()">{{"general.abort" | translate}}</button>
        <button type="button" class="btn btn-default" (click)="onSendNowClick()">{{"general.send now" | translate}}
        </button>
    </modal-footer>
</modal>

<modal #modal2>
    <modal-header>
        <h4 class="modal-title">{{"modal.transcription.sending.header" | translate}}</h4>
    </modal-header>
    <modal-body>
        {{"modal.transcription.sending.text" | translate}}<br/><br/>
        <div style="color:red">{{send_error}}</div>
    </modal-body>
</modal>

<div id="transcr-submit" class="panel panel-default">
    <h3>{{"transcription.check" | translate}}</h3>
    <p>
        {{"transcription-submit.overview" | translate}}
    </p>
    <app-transcr-overview [visible]="true" [show_transcriptiontable]="false"
                          [segments]="transcrService.annotation.tiers[0].segments.segments"></app-transcr-overview>
    <div *ngIf="!sessService.offline">
        <h3>Feedback</h3>
        <p>
            {{"transcription-submit.form fill out" | translate}}:
        </p>
        <section>
            <form (ngSubmit)="onSubmit(fo)" #fo="ngForm">
                <fieldset>
                    <div class="form-group" *ngFor="let group of transcrService.feedback.groups">
                        <label class="control-label">{{translate(group.title, langService.currentLang)}}</label>
                        <span class="required_marker" *ngIf="group.controls[0].required">*</span>
                        <br/>
                        <br/>
                        <div class="ctrl" *ngFor="let control of group.controls">
                            <div class="radio" *ngIf="control.type.type === 'radiobutton'">
                                <label>{{translate(control.label.languages, langService.currentLang)}}
                                    <input type="radio"
                                           name="{{control.name}}" value="{{control.value}}"
                                           [checked]="control.custom.checked"
                                           [required]="control.required"
                                           [(ngModel)]="feedback_data[control.name]"
                                    />
                                </label>
                            </div>
                            <div class="checkbox" *ngIf="control.type.type === 'checkbox'">
                                <label>
                                    <input type="checkbox"
                                           name="{{control.name}}" value="{{control.value}}"
                                           [checked]="control.custom.checked" #checkb
                                           [required]="control.required"
                                           [(ngModel)]="feedback_data[control.name]">
                                    <span class="required_marker" *ngIf="control.required">*</span>
                                    {{translate(control.label.languages, langService.currentLang)}}
                                </label>
                            </div>
                            <div *ngIf="control.type.type === 'textarea'">
                                <label>{{translate(control.label.languages, langService.currentLang)}}</label><br/>
                                <textarea class="form-control"
                                          name="{{control.name}}" value="{{control.value}}"
                                          [required]="control.required"></textarea>
                                          [(ngModel)]="feedback_data[control.name]"
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div>
                            <label>{{"transcription-submit.comment description" | translate}}</label><br/>
                            <textarea class="form-control" [(ngModel)]="transcrService.feedback.comment"
                                      name="comment"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="btn-group btn-group-justified" role="group" aria-label="...">
                            <button type="button" class="form-control" class="btn btn-raised"
                                    style="position:relative;width:49%;"
                                    (click)="back()"><span
                                    class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span> {{"general.back" | translate}}</span>
                            </button>
                            <button type="submit" class="form-control" class="btn btn-primary btn-raised"
                                    style="position:relative;width:49%;margin-left:2%;" [disabled]="!fo.valid"
                                    name="send">
                                <span>{{"transcription.send" | translate}} </span><span
                                    class="glyphicon glyphicon-send"></span></button>
                        </div>
                    </div>
                </fieldset>
            </form>
        </section>
    </div>
    <div *ngIf="sessService.offline">
        <h4>{{"general.export data"| translate}}</h4>
        <div class="row" style="padding:15px;">
            <div class="col-xs-6 export-button">
                <a download="{{transcrService.filename}}.txt" [href]="sanitize(getURI('text'))">
                    <div><span
                            class="glyphicon glyphicon-floppy-save export-glyphicon"></span><br/>{{"general.text file"|
                        translate}}
                    </div>
                </a><br/>
                <a class="export-a"
                   href="https://clarin.phonetik.uni-muenchen.de/BASWebServices/#/services/WebMAUSBasic"
                   target="_blank">{{"general.open"| translate:{value:"WebMAUS"} }}</a>
            </div>
            <div class="col-xs-6 export-button">
                <a download="{{transcrService.filename}}_annot.json" [href]="sanitize(getURI('annotJSON'))">
                    <div><span
                            class="glyphicon glyphicon-floppy-save export-glyphicon"></span><br/>annotJSON
                    </div>
                </a><br/>
                <a class="export-a"
                   href="http://ips-lmu.github.io/EMU-webApp/"
                   target="_blank">{{"general.open"| translate:{value:"EMU-Webapp"} }}</a>
            </div>
        </div>
        <button type="button" class="form-control" class="btn btn-raised"
                style="position:relative;width:100%;margin-top:40px;"
                (click)="back()"><span
                class="glyphicon glyphicon-menu-left"
                aria-hidden="true"></span><span> {{"general.back" | translate}}</span>
        </button>
    </div>
</div>