<app-alert #alert></app-alert>

<modal #modal_overview id="overview">
    <modal-header>
        <h4 class="modal-title">{{"general.overview" | translate}}</h4>
    </modal-header>
    <modal-body>
        <app-transcr-overview *ngIf="transcrService.segments != null" [visible]="modal_overview.visible" [segments]="transcrService.segments.segments"></app-transcr-overview>
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-default" data-dismiss="modal" (click)="modal_overview.dismiss()">
            {{"general.close" | translate}}
        </button>
    </modal-footer>
</modal>

<modal #modal_shortcuts>
    <modal-body>
        <div *ngIf="sessService.Interface == 'audioplayer'">
            <h3>{{"modal.shortcuts.audioplayer" | translate}}</h3>
            <div class="table-responsive">
                <table class="table table-hover">
                    <tbody>
                    <tr *ngFor="let entry of keyMap.getEntryList('AP')">
                        <td>{{"modal.shortcuts."+ entry.value.title | translate}}</td>
                        <td>{{entry.value.keys[platform]}} <span *ngIf="entry.value.focusonly" class="focus-info">({{"general.on focus only" | translate}})</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div *ngIf="(sessService.Interface == 'signaldisplay')">
            <h3>{{"modal.shortcuts.top signaldisplay" | translate}}</h3>
            <div class="table-responsive">
                <table class="table table-hover">
                    <tbody>
                    <tr *ngFor="let entry of keyMap.getEntryList('AV')">
                        <td>{{"modal.shortcuts."+ entry.value.title | translate}}</td>
                        <td>{{entry.value.keys[platform]}} <span *ngIf="entry.value.focusonly" class="focus-info">({{"general.on focus only" | translate}})</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <h3>{{"modal.shortcuts.down signaldisplay" | translate}}</h3>
            <div class="table-responsive">
                <table class="table table-hover">
                    <tbody>
                    <tr *ngFor="let entry of keyMap.getEntryList('Loupe')">
                        <td>{{"modal.shortcuts."+ entry.value.title |translate}}</td>
                        <td>{{entry.value.keys[platform]}} <span *ngIf="entry.value.focusonly" class="focus-info">({{"general.on focus only" | translate}})</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div *ngIf="(sessService.Interface == 'overlay')">
            <h3>{{"modal.shortcuts.2D-Editor" | translate}}</h3>
            <div class="table-responsive">
                <table class="table table-hover">
                    <tbody>
                    <tr *ngFor="let entry of keyMap.getEntryList('overlay')">
                        <td>{{"modal.shortcuts."+ entry.value.title | translate}}</td>
                        <td>{{entry.value.keys[platform]}} <span *ngIf="entry.value.focusonly" class="focus-info">({{"general.on focus only" | translate}})</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-primary" (click)="modal_shortcuts.dismiss();">
            {{"general.close" |translate}}
        </button>
    </modal-footer>
</modal>
<div *ngIf="!loaded">
    <app-loading #loading></app-loading>
</div>
<div *ngIf="loaded">
    <span id='saving' *ngIf="saving != ''"><i class="fa fa-spinner fa-spin" style="font-size:20px"></i></span>
    <app-fastbar
            [responsive]="responsive"
            [help_url]="help_url"
            [button_labels]="{
            shortcuts: 'general.shortcuts' | translate,
            guidelines: 'general.guidelines' | translate,
            overview: 'general.overview' | translate,
            help: 'general.help' | translate
            }"

            (shortcutbtnclicked)="modal_shortcuts.open()"
            (guidelinesbtnclicked)="modal_guidelines.open()"
            (overviewbtnclicked)="modal_overview.open()"
    ></app-fastbar>

    <app-transcr-guidelines #modal_guidelines [guidelines]="transcrService.guidelines"></app-transcr-guidelines>
    <div *ngIf="!(sessService.Interface == 'overlay')">
        <app-signal-gui #signalloupe *ngIf="sessService.Interface == 'signaldisplay'">
        </app-signal-gui>
        <app-audioplayer-gui #audioplayer *ngIf="sessService.Interface == 'audioplayer'"></app-audioplayer-gui>
    </div>
    <div *ngIf="sessService.Interface == 'overlay'">
        <app-overlay-gui></app-overlay-gui>
    </div>
    <div id="bottom-nav">
        <div class="btn-group btn-group-justified" role="group" aria-label="...">
            <a class="btn btn-default btn-raised"
               (click)="modService.show('transcription_stop', '', {ok: abortTranscription})"><span
                    class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span><span
                    [ngClass]="{'hidden-xs hidden-sm': appc.octra.responsive.enabled}"> {{"general.quit" | translate}}</span></a>
            <a class="btn btn-default btn-raised"
               (click)="submitTranscription()"><span [ngClass]="{'hidden-xs hidden-sm': appc.octra.responsive.enabled}"> {{"transcription.finish" | translate}}</span>
                <span
                        class="glyphicon glyphicon glyphicon-menu-right" aria-hidden="true"></span></a>
        </div>
    </div>
    <span class="link" (click)="showdetails = !showdetails">Details anzeigen</span>
    <div [hidden]="!showdetails">
        <h3>Transkriptionstext:</h3>
        <p>
            {{getText()}}
        </p>
        <table class="table">
            <thead>
            <tr>
                <th>Name</th>
                <th>Wert</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>Anzahl Segmente:</td>
                <td>{{transcrService.segments.length}}</td>
            </tr>
            <tr>
                <td>Anzahl Logeinträge:</td>
                <td>{{(UIElements != null) ? UIElements.length : 0}}</td>
            </tr>
            </tbody>
        </table>
        <h3 style="display:inline;">Ereignisse</h3> <button (click)="clearElements()">Ereignisse löschen</button>
        <div style="max-height:400px;overflow: scroll;">
            <table class="table" style="">
                <thead>
                <tr>
                    <th>Zeit</th>
                    <th>Typ</th>
                    <th>Ziel</th>
                    <th>Inhalt</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let elem of UIElements">
                    <td>{{elem.timestamp | date:"dd.MM.yy HH:mm:ss"}}</td>
                    <td>{{elem.type}}</td>
                    <td>{{elem.target_name}}</td>
                    <td>
                        {{elem.value}}
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <h3>
            Das Transkriptionsobjekt:
        </h3>
        <textarea style="width:100%; height:300px;">{{dat}}</textarea>
    </div>
</div>