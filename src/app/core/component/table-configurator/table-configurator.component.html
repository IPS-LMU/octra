<button class="btn btn-secondary" (click)="tableConfiguratorAddColumn()">
  <fa-icon icon="plus"></fa-icon>
  {{"tools.table configurator.add column" | transloco}}
</button>

<div class="easy-table" [ngStyle]="{
width: tableWidth + 'px'
}">
  <div class="inner" dragula="tableConfiguratorColumns"
       [(dragulaModel)]="columns" (dragulaModelChange)="onDragulaModelChange($event)">
    <div class="column" *ngFor="let column of columns; let i = index;">
      <div class="grip">
        <fa-icon [icon]="['fas', 'grip-lines']"></fa-icon>
      </div>
      <div class="delete-column" (click)="onDeleteColumnClick(i)">
        <fa-icon icon="times"></fa-icon>
      </div>
      <div class="header">
        <div contenteditable="true" #title
             (mouseleave)="onTitleLeave(title, i)"
             (keydown)="onTitleKeyDown($event)"
             (keyup)="onTitleKeyUp($event, title, i)" class="title">
          {{column.title}}
        </div>
        <div class="btn-group" dropdown style="display:block; width:100%;margin:0;">
          <button id="button-basic2" dropdownToggle type="button" class="btn btn-info btn-outline btn-sm"
                  aria-controls="dropdown-basic" style="width:100%;">
            {{"general.Format" | transloco}}: {{column.columnDefinition.selectedFormat.name}}
          </button>
          <ul id="dropdown-basic2" *dropdownMenu class="dropdown-menu"
              role="menu" aria-labelledby="button-basic" style="cursor: pointer">
            <li role="menuitem" class="dropdown-item" *ngFor="let format of column.columnDefinition.formats" [ngClass]="{
              'active': format.name === column.columnDefinition.selectedFormat.name
              }" (click)="onFormatClick(i, format)">
              {{format.name}} <span *ngIf="format.formatString !== ''" style="margin-left:5px;">({{format.formatString}}
              )</span>
            </li>
          </ul>
        </div>
      </div>
      <div class="cell" *ngFor="let cell of columns[i].columnDefinition.cells">
        {{cell.text | cliptext}}
      </div>
    </div>
    <div class="clearfix"></div>
  </div>
</div>

<div class="table-options">
  <form>
    <fieldset class="form-group">
      <div class="row">
        <legend class="col-form-label col-sm-2 pt-0">{{"tools.table configurator.divider" | transloco}}:</legend>
        <div class="col-sm-10">
          <div class="btn-group" dropdown>
            <button dropdownToggle type="button" class="btn btn-info btn-raised btn-sm"
                    aria-controls="dropdown-basic" style="width:100%;">
              {{tableOptions.divider.name}} ({{tableOptions.divider.value}})
            </button>
            <ul id="dropdown-basic3" *dropdownMenu class="dropdown-menu"
                role="menu" aria-labelledby="button-basic" style="cursor: pointer">
              <li role="menuitem" class="dropdown-item" *ngFor="let divider of tableOptions.selection.dividers"
                  (click)="onDividerClick(divider.value)"
              >
                {{divider.name}} ({{divider.value}})
              </li>
            </ul>
          </div>
        </div>
      </div>
    </fieldset>
    <fieldset class="form-group">
      <div class="row">
        <legend class="col-form-label col-sm-2 pt-0">{{"general.File extension" | transloco}}:</legend>
        <div class="col-sm-10">
          <div class="btn-group" dropdown>
            <button dropdownToggle type="button" class="btn btn-info btn-raised btn-sm"
                    aria-controls="dropdown-basic" style="width:100%;">
              {{tableOptions.fileExtension}}
            </button>
            <ul *dropdownMenu class="dropdown-menu"
                role="menu" aria-labelledby="button-basic" style="cursor: pointer">
              <li role="menuitem" class="dropdown-item" *ngFor="let extension of tableOptions.selection.extension"
                  (click)="onExtensionClick(extension)"
              >
                {{extension}}
              </li>
            </ul>
          </div>
        </div>
      </div>
    </fieldset>
    <div class="form-group row">
      <div class="col-sm-12">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="gridCheck1" name="addHeader"
                 [(ngModel)]="tableOptions.addHeader" (ngModelChange)="onSomethingDone()">
          <label class="form-check-label" for="gridCheck1" style="font-size: 14px;">
            {{"tools.table configurator.add header" | transloco}}
          </label>
        </div>
      </div>
    </div>
    <div class="form-group row">
      <div class="col-sm-10">
        <button type="submit" class="btn btn-primary btn-raised" (click)="generateFile()"
                [disabled]="this.columns.length < 1">{{"tools.table configurator.generate table" | transloco}}
        </button>
        <a [href]="this.resultURL" *ngIf="this.resultURL !== null" [download]="'test' + tableOptions.fileExtension"
           style="margin-left:10px;">{{"general.download" | transloco}}</a>
      </div>
    </div>
  </form>
</div>
