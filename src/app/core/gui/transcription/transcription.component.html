<app-alert #alert></app-alert>
<modal #modal>
    <modal-header>
        <h4 class="modal-title">{{"modal.transcription.send.header" | translate}}</h4>
    </modal-header>
    <modal-body>
        {{"modal.transcription.send.text" | translate}}
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-primary" (click)="modal.dismiss()">{{"general.abort" | translate}}</button>
        <button type="button" class="btn btn-default" (click)="onSendNowClick()">{{"general.send now" | translate}}
        </button>
    </modal-footer>
</modal>

<modal #modal2>
    <modal-header>
        <h4 class="modal-title">{{"modal.transcription.sending.header" | translate}}</h4>
    </modal-header>
    <modal-body>
        {{"modal.transcription.sending.text" | translate}}<br/><br/>
        <div style="color:red">{{send_error}}</div>
        <div class="text-success" style="text-align: center;display:block;">{{"general.submission success" |
            translate}}
        </div>
    </modal-body>
</modal>
<modal #modal_overview id="overview">
    <modal-body>
        <app-transcr-overview *ngIf="transcrService.annotation !== null"
                              [visible]="modal_overview.visible"
                              [segments]="(transcrService.annotation !== null && transcrService.annotation !== undefined)
                              ? transcrService.annotation.levels[transcrService.selectedlevel].segments.segments: null"
                              (segmentclicked)="onSegmentInOverviewClicked($event)">
        </app-transcr-overview>
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-default" data-dismiss="modal" (click)="modal_overview.dismiss()">
            {{"general.close" | translate}}
        </button>
    </modal-footer>
</modal>

<modal #modal_shortcuts>
    <modal-body *ngIf="editorloaded">
        <div *ngIf="interface == 'Editor without signal display'">
            <h3>{{"modal.shortcuts.audioplayer" | translate}}</h3>
            <div class="table-responsive" *ngIf="keyMap.getEntryList('AP') !== null">
                <table class="table table-hover">
                    <tbody>
                    <tr *ngFor="let entry of keyMap.getEntryList('AP')">
                        <td>{{"modal.shortcuts."+ entry.value.title | translate}}</td>
                        <td>{{entry.value.keys[platform]}} <span *ngIf="entry.value.focusonly" class="focus-info">({{"general.on focus only" | translate}})</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div *ngIf="(interface == 'Linear Editor')">
            <h3>{{"modal.shortcuts.top signaldisplay" | translate}}</h3>
            <div class="table-responsive" *ngIf="keyMap.getEntryList('AV') !== null">
                <table class="table table-hover">
                    <tbody>
                    <tr *ngFor="let entry of keyMap.getEntryList('AV')">
                        <td>{{"modal.shortcuts."+ entry.value.title | translate}}</td>
                        <td>{{entry.value.keys[platform]}} <span *ngIf="(entry.value !== null && entry.value.focusonly)"
                                                                 class="focus-info">({{"general.on focus only" | translate}})</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <h3>{{"modal.shortcuts.down signaldisplay" | translate}}</h3>
            <div class="table-responsive" *ngIf="keyMap.getEntryList('Loupe') !== null">
                <table class="table table-hover">
                    <tbody>
                    <tr *ngFor="let entry of keyMap.getEntryList('Loupe')">
                        <td>{{"modal.shortcuts."+ entry.value.title |translate}}</td>
                        <td>{{entry.value.keys[platform]}} <span *ngIf="(entry.value !== null && entry.value.focusonly)"
                                                                 class="focus-info">({{"general.on focus only" | translate}})</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div *ngIf="(interface == '2D-Editor')">
            <h3>{{"modal.shortcuts.2D-Editor" | translate}}</h3>
            <div class="table-responsive">
                <table class="table table-hover">
                    <tbody>
                    <tr *ngFor="let entry of keyMap.getEntryList('2D-Editor')">
                        <td>{{"modal.shortcuts."+ entry.value.title | translate}}</td>
                        <td>{{entry.value.keys[platform]}} <span *ngIf="entry.value.focusonly" class="focus-info">({{"general.on focus only" | translate}})</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-primary" (click)="modal_shortcuts.dismiss();">
            {{"general.close" |translate}}
        </button>
    </modal-footer>
</modal>

<modal #success id="transcription_success">
    <modal-body>
        <p>{{"transcription submitted.no jobs left" | translate}}</p>
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-default" data-dismiss="modal" (click)="success.dismiss()">{{"general.close"
            | translate}}
        </button>
    </modal-footer>
</modal>

<div class="flex">
    <span id='saving'>
        <span *ngIf="saving === 'saving'" style="color:#333333" class="glyphicon glyphicon-floppy-disk"></span>
        <span *ngIf="saving === 'error'" style="color:red" class="glyphicon glyphicon-floppy-disk"></span>
    </span>
    <app-fastbar
            [responsive]="responsive"
            [button_labels]="{
            shortcuts: 'general.shortcuts' | translate,
            guidelines: 'general.guidelines' | translate,
            overview: 'general.overview' | translate,
            help: 'general.help' | translate
            }"

            (shortcutbtnclicked)="modal_shortcuts.open()"
            (guidelinesbtnclicked)="modal_guidelines.open()"
            (overviewbtnclicked)="modal_overview.open()"
    ></app-fastbar>

    <app-transcr-guidelines #modal_guidelines [guidelines]="transcrService.guidelines">
    </app-transcr-guidelines>

    <div class="flex">
        <ng-template appLoadeditor></ng-template>
    </div>

    <div id="bottom-feedback" class="panel" #feedback
         *ngIf="!appStorage.uselocalmode && transcrService.feedback !== null && transcrService.feedback !== undefined">
        <table style="width:100%;">
            <tbody>
            <tr>
                <td><span class="link" (click)="expandFeedback()" style="width:100%;display: block;">FEEDBACK <span
                        class="required_marker" *ngIf="transcrService.feedback.required">*</span></span>
                </td>
                <td style="text-align: right">
                    <span *ngIf="!feedback_expanded" class="glyphicon glyphicon-chevron-up"
                          (click)="expandFeedback()"
                          style="color:grey; display: block; padding:0;cursor:pointer;margin-bottom:10px;"
                    >
                    </span>
                    <span *ngIf="feedback_expanded" class="glyphicon glyphicon-chevron-down"
                          (click)="expandFeedback()"
                          style="color:grey; display: block; padding:0;cursor:pointer;margin-bottom:10px;"
                    >
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
        <div class="inner">
            <form #fo="ngForm">
                <fieldset>
                    <div class="form-group" *ngFor="let group of transcrService.feedback.groups">
                        <label class="control-label">{{translate(group.title, langService.currentLang)}}</label>
                        <span class="required_marker" *ngIf="group.controls[0].required">*</span>
                        <br/>
                        <br/>
                        <div class="ctrl" *ngFor="let control of group.controls;">
                            <div class="radio" *ngIf="control.type.type === 'radiobutton'">
                                <label>{{translate(control.label.languages, langService.currentLang)}}
                                    <input type="radio"
                                           name="{{group.name}}" value="{{control.value}}"
                                           [checked]="control.custom.checked"
                                           [required]="control.required"
                                           [(ngModel)]="feedback_data[group.name]"
                                    />
                                </label>
                            </div>
                            <div class="checkbox" *ngIf="control.type.type === 'checkbox'">
                                <label>
                                    <input type="checkbox"
                                           name="{{control.value}}" value="true"
                                           [checked]="control.custom.checked" #checkb
                                           [required]="control.required"
                                           (change)="checkBoxChanged(group.name, control.value)">
                                    <span class="required_marker" *ngIf="control.required">*</span>
                                    {{translate(control.label.languages, langService.currentLang)}}
                                </label>
                            </div>
                            <div *ngIf="control.type.type === 'textarea'">
                                <label>{{translate(control.label.languages, langService.currentLang)}}</label><br/>
                                <textarea class="form-control"
                                          name="{{group.name}}" value="{{control.value}}"
                                          [required]="control.required"></textarea>
                                [(ngModel)]="feedback_data[group.name]"
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div>
                            <label>{{"transcription-submit.comment description" | translate}}</label><br/>
                            <textarea class="form-control" [(ngModel)]="transcrService.feedback.comment"
                                      name="comment"></textarea>
                        </div>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>
    <div id="bottom-nav">
        <div class="btn-group btn-group-justified" role="group" aria-label="...">
            <a class="btn btn-default btn-raised"
               (click)="modService.show('transcription_stop', '', {ok: abortTranscription})"><span
                    class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span><span
                    *ngIf="!appStorage.easymode"
                    [ngClass]="{'hidden-xs hidden-sm': appc.octra.responsive.enabled}"> {{"general.quit" | translate}}</span></a>

            <a class="btn btn-primary btn-raised"
               (click)="navbarServ.doclick('export');" *ngIf="appStorage.uselocalmode"><span
                    *ngIf="!appStorage.easymode"
                    [ngClass]="{'hidden-xs hidden-sm': appc.octra.responsive.enabled}"> {{"general.export data" | translate}}</span>
                <span class="glyphicon glyphicon-download"></span></a>

            <a class="btn btn-primary btn-raised"
               (click)="onSendButtonClick()" *ngIf="!appStorage.uselocalmode"><span
                    *ngIf="!appStorage.easymode"
                    [ngClass]="{'hidden-xs hidden-sm': appc.octra.responsive.enabled}"> {{"transcription.send" | translate}}</span>
                <span class="glyphicon glyphicon-send"></span></a>
        </div>
    </div>
</div>